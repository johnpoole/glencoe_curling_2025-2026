<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Curling Draw Simulator — D3</title>
<script src="https://d3js.org/d3.v7.min.js"></script>
<link rel="stylesheet" href="css/styles.css">
</head>
<body>
<div class="wrap">
  <!-- Sheet panel first (full width) -->
  <div class="panel">
    <svg id="rink"></svg>
  </div>
  
  <!-- Controls panel below -->
  <div class="panel controls-panel">
    <!-- First column - Shot parameters -->
    <fieldset>
      <legend>Shot</legend>
      <label>Initial speed V0 (m/s)
        <input id="V0" type="number" step="0.01" min="0.1" max="6" value="2.0">
      </label>
      <div class="row">
        <label>Spin |ω0| (rad/s)
          <input id="omega0" type="number" step="0.01" min="0" max="5" value="1.45">
        </label>
        <label>Turn
          <select id="turn"><option value="out">out (CW)</option><option value="in">in (CCW)</option></select>
        </label>
      </div>
      <div class="row">
        <label>ice speed
          <input id="mu0" type="number" step="0.0005" min="0.001" max="0.03" value="0.008">
        </label>
        <label>stone sharpness
          <input id="alpha" type="number" step="0.0005" min="0.0" max="0.1" value="0.014">
        </label>
      </div>
      <label>Sweep factor (×)
        <input id="sweep" type="number" step="0.01" min="0.5" max="1.5" value="1.0">
      </label>
    </fieldset>

    <fieldset>
      <legend>Advanced</legend>
      <div class="row">
        <label>segments
          <input id="segments" type="number" step="1" min="60" max="720" value="180">
        </label>
        <label>dt (s)
          <input id="dt" type="number" step="0.001" min="0.001" max="0.05" value="0.01">
        </label>
      </div>
      <div class="row">
        <label>t_max (s)
          <input id="tmax" type="number" step="1" min="5" max="120" value="60">
        </label>
        <label>r_band (m)
          <input id="rband" type="number" step="0.001" min="0.04" max="0.09" value="0.065">
        </label>
      </div>
      <label>R (rock radius, m)
        <input id="R" type="number" step="0.001" min="0.12" max="0.17" value="0.145">
      </label>
      <div class="small">Click on the sheet to place the skip’s broom. Rock won’t move until you press <b>Throw</b>.</div>
    </fieldset>

    <!-- Third column - Buttons and metrics -->
    <div>
      <div class="buttons">
        <button id="throwBtn">Throw</button>
        <button id="resetBtn" class="secondary">Reset</button>
        <button id="csvBtn" class="secondary">Export CSV</button>
        <button id="stopBtn" class="warn">Stop</button>
      </div>
      
      <hr style="border:0;border-top:1px solid #2a3a52; margin:10px 0;">
      
      <!-- Stone control buttons -->
      <fieldset>
        <legend>Stones</legend>
        <div class="buttons">
          <button id="addRedBtn" class="secondary" style="background:#e74c3c;color:#fff">Add Red</button>
          <button id="addYellowBtn" class="secondary" style="background:#f1c40f;color:#333">Add Yellow</button>
          <button id="removeStoneBtn" class="secondary">Remove Selected</button>
          <button id="clearStonesBtn" class="warn">Clear All</button>
        </div>
        <div class="small" style="margin-top:8px">Click a stone to select it for throwing or removing.</div>
      </fieldset>
      
      <hr style="border:0;border-top:1px solid #2a3a52; margin:10px 0;">
      <div class="metrics-container">
        <div class="metric"><span>Final x (m)</span><span class="v" id="mx"></span></div>
        <div class="metric"><span>Final curl y (m)</span><span class="v" id="my"></span></div>
        <div class="metric"><span>Total time (s)</span><span class="v" id="mt"></span></div>
        <div class="metric"><span>Hog→Hog time (s)</span><span class="v" id="mhh"></span></div>
      </div>
    </div>
  </div>
</div>

<script type="module" src="js/app.js"></script>
</body>
</html>
